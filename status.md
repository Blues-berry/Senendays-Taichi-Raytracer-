第一阶段：算法深度优化（补齐核心技术论点）
这一阶段的目标是解决 Hybrid 算法最容易被审稿人攻击的缺点：漏光和噪声。

指令 1：实现基于深度的遮挡判定（解决漏光）

“请在 camera.py 的 update_grid 逻辑中，为每个网格点增加一个 ti.f32 字段存储 mean_dist（平均深度）。在探测采样时，记录光线击中物体的距离。修改渲染时的采样逻辑：如果当前着色点到网格点的实际距离与 mean_dist 偏差超过 20%，则认为该网格点被遮挡，将其采样权重置为 0。这用于解决论文中提到的漏光（Light Leaking）问题。”

指令 2：实现时域滤波与降噪（提升画质稳定性）

“请在 camera.py 中引入一个简单的 时域累积缓存（Accumulation Buffer）。不要使用全局平均，而是实现一个基于权重的指数移动平均（EMA）。对于检测到物体移动的区域，降低历史权重；对于静态区域，增加累积帧数。这将使我们在论文中能够展示出‘即便在极低采样率下也能获得平滑画质’的能力。”

第二阶段：自动化消融实验（生产论文图表）
论文必须通过对比证明你每一个设计改进的有效性。

指令 3：重构 benchmark.py 以支持自动化消融实验

“请修改 benchmark.py，允许通过配置参数开关以下功能：

interpolation_on (三线性插值)

importance_sampling_on (光源重要性采样)

adaptive_logic_on (自适应权重更新) 编写一个主循环，依次运行：Baseline（全关）、V1（仅插值）、V2（插值+自适应）、Full_Hybrid（全开）。将四组数据分别存入不同的 CSV，确保每组实验都包含相同的球体位移触发。”

指令 4：生成高质量学术对比图（Python 绘图指令）

“请修改 plot_results.py。读取消融实验产出的四份 CSV。在同一张图中绘制 MSE 随帧数变化的对比曲线。要求：使用 logarithmic（对数）纵轴，添加清晰的图例，并在位移发生帧（Frame 200）处画一条灰色虚线并标注 'Object Movement'。确保图片以 300DPI 的 PDF 格式输出，以便插入 LaTeX 论文。”

第三阶段：多场景压力测试（论证泛化性）
审稿人需要看到算法在不同复杂程度场景下的表现。

指令 5：完善 Cornell Box 场景（验证间接光照）

“在 main.py 的 setup_scene 中完善 cornell_box 模式。要求：

构造标准的五面墙体，其中左右墙分别为红色和绿色（验证颜色溢出效应 Color Bleeding）。

顶部放置一个强发光平面光源。

内部放置两个球：一个高反射金属球，一个折射玻璃球。

确保 Grid 能够自动适应盒子的 AABB 范围。”

指令 6：增加误差热力图（Error Heatmap）渲染

“请在渲染逻辑中增加一个 RENDER_MODE_ERROR。该模式下，计算每个像素的 abs(Hybrid_Color - PT_Reference_Color)，并将误差大小映射为伪彩色（冷色代表低误差，红色代表高误差）。保存移动后的第 5 帧和第 50 帧的热力图。这在论文中用于直观展示算法在阴影边缘的收敛过程。”

第四阶段：量化性能分析（支撑 Conclusion）
指令 7：统计显存与计算开销

“请编写一个脚本统计不同网格分辨率（16^3, 32^3, 64^3）下的显存占用（MB）和每帧网格更新耗时（ms）。在 benchmark_results.csv 中增加一列记录每帧的 GPU 耗时。我们需要这些数据来绘制‘画质 vs 性能’的权衡曲线（Trade-off Curve）。”

💡 建议执行顺序：
先执行指令 3 和 4：拿到目前最扎实的消融对比数据，这是论文的骨架。

执行指令 5 和 6：准备场景素材，生成能够放在论文第一页的展示大图（Teaser Image）。

最后执行指令 1 和 2：如果时间充裕，这两项优化能将你的论文档次从 B 类提升到 A 类。